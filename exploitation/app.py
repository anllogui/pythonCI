# app.py - a minimal flask api using flask_restful
from flask import (
    Flask, request, jsonify
)
from flask_restful import Resource, Api
import os
import joblib 
import pandas as pd
from sklearn.linear_model import LinearRegression

app = Flask(__name__)
api = Api(app)

class Predict(Resource):
    def get(self):
        return {'hello': 'world'}
    def post(self):
        if request.method == 'POST':
            try:
                data = request.get_json()
                years_of_experience = [[float(data["yearsOfExperience"])]]
                lin_reg = joblib.load("model/linear_regression_model.pkl")
            except ValueError:
                return jsonify("Please enter a number.")

        return jsonify(lin_reg.predict(years_of_experience).tolist())
        
"""
curl -i -H "Content-Type: application/json" -X POST -d '{"yearsOfExperience":8}' http://localhost:5000/
"""

api.add_resource(Predict, '/')

if __name__ == '__main__':
    app.run(debug=True)